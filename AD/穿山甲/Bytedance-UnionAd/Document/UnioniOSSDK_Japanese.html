<!DOCTYPE html>
<html>
<head>
<title>UnioniOSSDK_Japanese.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
	font-size: 14px;
	padding: 0 12px;
	line-height: 22px;
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}


body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	color: #4080D0;
	text-decoration: none;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

h1 code,
h2 code,
h3 code,
h4 code,
h5 code,
h6 code {
	font-size: inherit;
	line-height: auto;
}

a:hover {
	color: #4080D0;
	text-decoration: underline;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left: 5px solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 14px;
	line-height: 19px;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

.mac code {
	font-size: 12px;
	line-height: 18px;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

/** Theming */

.vscode-light,
.vscode-light pre code {
	color: rgb(30, 30, 30);
}

.vscode-dark,
.vscode-dark pre code {
	color: #DDD;
}

.vscode-high-contrast,
.vscode-high-contrast pre code {
	color: white;
}

.vscode-light code {
	color: #A31515;
}

.vscode-dark code {
	color: #D7BA7D;
}

.vscode-light pre:not(.hljs),
.vscode-light code > div {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre:not(.hljs),
.vscode-dark code > div {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre:not(.hljs),
.vscode-high-contrast code > div {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

.vscode-light blockquote,
.vscode-dark blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.vscode-high-contrast blockquote {
	background: transparent;
	border-color: #fff;
}
</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family:  "Meiryo", "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

</head>
<body>
<h1 id="toutiao%E9%80%A3%E7%9B%9F-ios-sdk-%E3%81%AE%E6%8E%A5%E7%B6%9A%E8%AA%AC%E6%98%8E">Toutiao連盟 iOS SDK の接続説明</h1>
<!-- TOC -->
<ul>
<li><a href="#toutiao%E9%80%A3%E7%9B%9F-ios-sdk-%E3%81%AE%E6%8E%A5%E7%B6%9A%E8%AA%AC%E6%98%8E">Toutiao連盟 iOS SDK の接続説明</a>
<ul>
<li><a href="#1-%E3%82%A6%E3%82%A7%E3%83%96%E3%82%B5%E3%82%A4%E3%83%88%E5%90%8C%E7%9B%9Fios-sdk%E3%81%AE%E6%8E%A5%E7%B6%9A">1. ウェブサイト同盟iOS SDKの接続</a>
<ul>
<li><a href="#11-ios-sdk%E3%81%ABframework%E3%82%92%E5%B0%8E%E5%85%A5">1.1 iOS SDKにframeworkを導入</a>
<ul>
<li><a href="#111-%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AEappid%E3%81%A8slotid%E3%81%AE%E7%94%B3%E8%AB%8B">1.1.1 アプリケーションのAppIDとSlotIDの申請</a></li>
<li><a href="#112-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E8%A8%AD%E5%AE%9A%E3%81%ABframework%E3%82%92%E5%B0%8E%E5%85%A5%E3%81%99%E3%82%8B">1.1.2 プロジェクト設定にframeworkを導入する</a></li>
<li><a href="#%E6%96%B9%E6%B3%95%E4%B8%80">方法一：</a></li>
<li><a href="#%E6%96%B9%E6%B3%95%E4%BA%8C">方法二：</a></li>
</ul>
</li>
<li><a href="#12-xcode%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E8%A8%AD%E5%AE%9A">1.2 Xcodeコンパイルオプションの設定</a>
<ul>
<li><a href="#121-%E6%A8%A9%E9%99%90%E8%BF%BD%E5%8A%A0">1.2.1 権限追加</a></li>
<li><a href="#122-%E5%8B%95%E4%BD%9C%E7%92%B0%E5%A2%83">1.2.2 動作環境</a></li>
<li><a href="#123-%E4%BE%9D%E5%AD%98%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E8%BF%BD%E5%8A%A0">1.2.3 依存ライブラリの追加</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#2-sdk%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E7%B4%B9%E4%BB%8B%E3%81%A8%E5%BA%83%E5%91%8A%E3%81%AE%E6%8E%A5%E7%B6%9A">2. SDKインターフェイスクラスの紹介と広告の接続</a>
<ul>
<li><a href="#21-%E3%82%B0%E3%83%AD%E3%83%BC%E3%83%90%E3%83%AB%E8%A8%AD%E5%AE%9Abuadsdkmanager">2.1 グローバル設定(BUAdSDKManager)</a>
<ul>
<li><a href="#211-%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%81%AE%E8%AA%AC%E6%98%8E">2.1.1 インターフェイスの説明</a></li>
<li><a href="#212-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">2.1.2 使用方法</a></li>
</ul>
</li>
<li><a href="#22-%E3%83%AA%E3%83%AF%E3%83%BC%E3%83%89%E5%8B%95%E7%94%BBburewardedvideoad">2.2 リワード動画(BURewardedVideoAd)</a>
<ul>
<li><a href="#221-burewardedvideoad%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%81%AE%E8%AA%AC%E6%98%8E">2.2.1 BURewardedVideoAdインターフェイスの説明</a></li>
<li><a href="#222-burewardedvideoad%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E3%81%AE%E8%AA%AC%E6%98%8E">2.2.2 BURewardedVideoAdコールバックの説明</a></li>
<li><a href="#223-%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9">2.2.3 インスタンス</a></li>
<li><a href="#224-burewardedvideomodel">2.2.4 BURewardedVideoModel</a></li>
<li><a href="#225-%E3%82%B5%E3%83%BC%E3%83%90%E3%81%8B%E3%82%89%E3%82%B5%E3%83%BC%E3%83%90%E3%81%B8%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF">2.2.5 サーバからサーバへのコールバック</a>
<ul>
<li><a href="#%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E6%96%B9%E6%B3%95%E3%81%AE%E8%AA%AC%E6%98%8E">コールバック方法の説明</a></li>
<li><a href="#%E3%82%B5%E3%82%A4%E3%83%B3%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95">サイン作成方法</a></li>
<li><a href="#%E8%A6%8F%E7%B4%84%E3%81%AB%E6%88%BB%E3%82%8B">規約に戻る</a></li>
</ul>
</li>
<li><a href="#226-admob%E3%81%8Ccustomevent-adapter%E3%81%AE%E6%96%B9%E6%B3%95%E3%81%A7%E3%83%AA%E3%83%AF%E3%83%BC%E3%83%89%E5%8B%95%E7%94%BB%E3%82%92%E7%B5%B1%E5%90%88%E3%81%99%E3%82%8B">2.2.6 AdMobがCustomEvent Adapterの方法でリワード動画を統合する</a></li>
</ul>
</li>
<li><a href="#23-%E3%83%95%E3%83%AB%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E5%8B%95%E7%94%BBbufullscreenvideoad">2.3 フルスクリーン動画(BUFullscreenVideoAd)</a>
<ul>
<li><a href="#231-bufullscreenvideoad%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%81%AE%E8%AA%AC%E6%98%8E">2.3.1 BUFullscreenVideoAdインターフェイスの説明</a></li>
<li><a href="#232-bufullscreenvideoad%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E3%81%AE%E8%AA%AC%E6%98%8E">2.3.2 BUFullscreenVideoAdコールバックの説明</a></li>
<li><a href="#233-%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9">2.3.3 インスタンス</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E4%BB%98%E9%8C%B2">付録</a>
<ul>
<li><a href="#sdk%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%B3%E3%83%BC%E3%83%89">SDKエラーコード</a></li>
<li><a href="#faq">FAQ</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="1-%E3%82%A6%E3%82%A7%E3%83%96%E3%82%B5%E3%82%A4%E3%83%88%E5%90%8C%E7%9B%9Fios-sdk%E3%81%AE%E6%8E%A5%E7%B6%9A">1. ウェブサイト同盟iOS SDKの接続</h2>
<h3 id="11-ios-sdk%E3%81%ABframework%E3%82%92%E5%B0%8E%E5%85%A5">1.1 iOS SDKにframeworkを導入</h3>
<h4 id="111-%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AEappid%E3%81%A8slotid%E3%81%AE%E7%94%B3%E8%AB%8B">1.1.1 アプリケーションのAppIDとSlotIDの申請</h4>
<p>TikTok Audience NetworkにAppIDと広告SlotIDを申請してください。</p>
<h4 id="112-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E8%A8%AD%E5%AE%9A%E3%81%ABframework%E3%82%92%E5%B0%8E%E5%85%A5%E3%81%99%E3%82%8B">1.1.2 プロジェクト設定にframeworkを導入する</h4>
<h4 id="%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A">方法一：</h4>
<p>frameworkファイルを取得後、{BUAdSDK.framework, BUAdSDK.bundle}ファイルをプロジェクトに直接、ドラッグ&amp;ドロップすれば完了です。</p>
<p>ドラッグ&amp;ドロップするときは、以下の方法で選択してください。</p>
<p><img src="images/bu_1.png" alt="image"></p>
<p>ドラッグ&amp;ドロップ完了後は、Copy Bundle ResourcesにBUAdSDK.bundleが含まれていることを確認してください。含まれていないと、incon画像をロードできないことがあります。</p>
<p><img src="images/bu_5.png" alt="image"></p>
<h4 id="%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A">方法二：</h4>
<p>SDK2000バージョン以降はpod方式による接続をサポートしています。pod環境を設定し、podfileに以下のコードを入れるだけで接続できます。</p>
<pre class="hljs"><code><div>pod 'Bytedance-UnionAD', '~&gt; 2.0.0.0'
</div></code></pre>
<p>pod方式の接続について更に詳しくお知りになりたい方は<a href="https://github.com/bytedance/Bytedance-UnionAD">gitthub</a>アドレスをご参照ください</p>
<h3 id="12-xcode%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E8%A8%AD%E5%AE%9A">1.2 Xcodeコンパイルオプションの設定</h3>
<h4 id="121-%E6%A8%A9%E9%99%90%E8%BF%BD%E5%8A%A0">1.2.1 権限追加</h4>
<p><strong>追加するシステムライブラリに注意すること</strong></p>
<ul>
<li>プロジェクトplistファイルは、右側のinformation Property List後ろの「+」をクリック、展開します</li>
</ul>
<p>App Transport Security Settingsを追加するには、まず左側の展開矢印をクリックし、さらに右側のプラスマークをクリックすると、自動的にAllow Arbitrary Loadsオプションが追加され、値がYESに変更されます。SDK APIは全HTTPSをサポートしていますが、広告主のクリエイティブが非HTTPSの場合もあります。</p>
<pre class="hljs"><code><div>&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;
&lt;dict&gt;
&lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;
&lt;true/&gt;
&lt;/dict&gt;
</div></code></pre>
<p>詳しい操作は図の通りです。</p>
<p><img src="images/bu_2.png" alt="image"></p>
<ul>
<li>Build SettingsのOther Linker Flags <strong>-ObjCパラメータを追加</strong>、SDKは同時に-all_loadをサポート
詳しい操作は図の通りです。</li>
</ul>
<p><img src="images/bu_3.png" alt="image"></p>
<h4 id="122-%E5%8B%95%E4%BD%9C%E7%92%B0%E5%A2%83">1.2.2 動作環境</h4>
<ul>
<li>iOS 8.X以上のシステムをサポート</li>
<li>SDKコンパイル環境Xcode 9.4, Base SDK 11.1、</li>
<li>対応アーキテクチャ：i386, x86-64, armv7, armv7s, arm64</li>
</ul>
<h4 id="123-%E4%BE%9D%E5%AD%98%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E8%BF%BD%E5%8A%A0">1.2.3 依存ライブラリの追加</h4>
<p>プロジェクトはTARGETS -&gt; Build PhasesでLink Binary With Librariesを検索し、「+」をクリック、下記依存ライブラリを追加する必要があります</p>
<ul>
<li>StoreKit.framework</li>
<li>MobileCoreServices.framework</li>
<li>WebKit.framework</li>
<li>MediaPlayer.framework</li>
<li>CoreMedia.framework</li>
<li>AVFoundation.framework</li>
<li>CoreLocation.framework</li>
<li>CoreTelephony.framework</li>
<li>SystemConfiguration.framework</li>
<li>Photos.framework</li>
<li>AdSupport.framework</li>
<li>CoreMotion.framework</li>
<li>libresolv.9.tbd</li>
<li>libc++.tbd</li>
<li>libz.tbd
詳しい操作は図の通りです。</li>
</ul>
<p><img src="images/bu_4.png" alt="image"></p>
<h2 id="2-sdk%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AE%E7%B4%B9%E4%BB%8B%E3%81%A8%E5%BA%83%E5%91%8A%E3%81%AE%E6%8E%A5%E7%B6%9A">2. SDKインターフェイスクラスの紹介と広告の接続</h2>
<h3 id="21-%E3%82%B0%E3%83%AD%E3%83%BC%E3%83%90%E3%83%AB%E8%A8%AD%E5%AE%9Abuadsdkmanager">2.1 グローバル設定(BUAdSDKManager)</h3>
<p>BUAdSDKManagerクラスはSDK全体に設定されている入力ポートとインターフェイスであり、 SDKに関するグローバル情報の設定や、クラスメソッドの設定取得結果の提供が可能です。</p>
<h4 id="211-%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%81%AE%E8%AA%AC%E6%98%8E">2.1.1 インターフェイスの説明</h4>
<p>現在、インターフェイスでは以下のクラスメソッドを提供しています</p>
<pre class="hljs"><code><div>/**
 Register the App key that’s already been applied before requesting an ad from TikTok Audience Network.
 @param appID : the unique identifier of the App
 */
+ (void)setAppID:(NSString *)appID;

/**
 Configure development mode.
 @param level : default BUAdSDKLogLevelNone
 */
+ (void)setLoglevel:(BUAdSDKLogLevel)level;

/// Set the gender of the user.
+ (void)setUserGender:(BUUserGender)userGender;

/// Set the age of the user.
+ (void)setUserAge:(NSUInteger)userAge;

/// Set the user's keywords, such as interests and hobbies, etc.
+ (void)setUserKeywords:(NSString *)keywords;

/// set additional user information.
+ (void)setUserExtData:(NSString *)data;

/// Set whether the app is a paid app, the default is a non-paid app
+ (void)setIsPaidApp:(BOOL)isPaidApp;

+ (NSString *)appID;
+ (BOOL)isPaidApp;
</div></code></pre>
<h4 id="212-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">2.1.2 使用方法</h4>
<p>SDKはAppDelegateで <code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</code>初期化する必要があります</p>
<p>そのうち、以下の設定は<strong>必須</strong>です。また、関連appIDの設定を使用する必要があります</p>
<pre class="hljs"><code><div>[BUAdSDKManager setAppID:@&quot;xxxxxx&quot;];
</div></code></pre>
<p>使用方法について更に詳しくお知りになりたい方はSDK Demoプロジェクトをご参照ください</p>
<h3 id="22-%E3%83%AA%E3%83%AF%E3%83%BC%E3%83%89%E5%8B%95%E7%94%BBburewardedvideoad">2.2 リワード動画(BURewardedVideoAd)</h3>
<ul>
<li>**タイプ説明：**動画リワード広告は斬新な広告形式です。ユーザは動画広告を見ることで報酬を手に入れることができます。例えば、仮想通貨、アプリ内グッズや自社のコンテンツ等です。このような広告の長さは15～30秒で、スキップできません。また、広告の終了画面には終了と表示され、ユーザの次の操作へ誘導します。</li>
</ul>
<h4 id="221-burewardedvideoad%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%81%AE%E8%AA%AC%E6%98%8E">2.2.1 BURewardedVideoAdインターフェイスの説明</h4>
<p><strong>毎回新たにBURewardedVideoAdオブジェクトを生成し、loadAdDataを呼び出す方法で最新のリワード動画をリクエストする必要があります。繰り返しローカルキャッシュを使用して、何度もリワード動画を展示することはおやめください。</strong></p>
<pre class="hljs"><code><div>@interface BURewardedVideoAd : NSObject
@property (nonatomic, strong) BURewardedVideoModel *rewardedVideoModel;
@property (nonatomic, weak, nullable) id&lt;BURewardedVideoAdDelegate&gt; delegate;

/**
Whether material is effective.
Setted to YES when data is not empty and has not been displayed.
Repeated display is not billed.
*/
@property (nonatomic, getter=isAdValid, readonly) BOOL adValid;

- (instancetype)initWithSlotID:(NSString *)slotID rewardedVideoModel:(BURewardedVideoModel *)model;
- (void)loadAdData;
- (BOOL)showAdFromRootViewController:(UIViewController *)rootViewController;

@end
</div></code></pre>
<h4 id="222-burewardedvideoad%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E3%81%AE%E8%AA%AC%E6%98%8E">2.2.2 BURewardedVideoAdコールバックの説明</h4>
<pre class="hljs"><code><div>@protocol BURewardedVideoAdDelegate &lt;NSObject&gt;

@optional

/**
This method is called when video ad material loaded successfully.
*/
- (void)rewardedVideoAdDidLoad:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad materia failed to load.
@param error : the reason of error
*/
- (void)rewardedVideoAd:(BURewardedVideoAd *)rewardedVideoAd didFailWithError:(NSError *)error;

/**
This method is called when video cached successfully.
*/
- (void)rewardedVideoAdVideoDidLoad:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad slot will be showing.
*/
- (void)rewardedVideoAdWillVisible:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad slot has been shown.
*/
- (void)rewardedVideoAdDidVisible:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad is about to close.
*/
- (void)rewardedVideoAdWillClose:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad is closed.
*/
- (void)rewardedVideoAdDidClose:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad is clicked.
*/
- (void)rewardedVideoAdDidClick:(BURewardedVideoAd *)rewardedVideoAd;


/**
This method is called when video ad play completed or an error occurred.
@param error : the reason of error
*/
- (void)rewardedVideoAdDidPlayFinish:(BURewardedVideoAd *)rewardedVideoAd didFailWithError:(NSError *)error;

/**
Server verification which is requested asynchronously is succeeded.
@param verify :return YES when return value is 2000.
*/
- (void)rewardedVideoAdServerRewardDidSucceed:(BURewardedVideoAd *)rewardedVideoAd verify:(BOOL)verify;

/**
Server verification which is requested asynchronously is failed.
Return value is not 2000.
*/
- (void)rewardedVideoAdServerRewardDidFail:(BURewardedVideoAd *)rewardedVideoAd;
/**
This method is called when the user clicked skip button.
*/
- (void)rewardedVideoAdDidClickSkip:(BURewardedVideoAd *)rewardedVideoAd;
@end

</div></code></pre>
<h4 id="223-%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9">2.2.3 インスタンス</h4>
<pre class="hljs"><code><div>BURewardedVideoModel *model = [[BURewardedVideoModel alloc] init];
model.userId = @&quot;123&quot;;
model.isShowDownloadBar = YES;
self.rewardedVideoAd = [[BURewardedVideoAd alloc] initWithSlotID:self.viewModel.slotID rewardedVideoModel:model];
self.rewardedVideoAd.delegate = self;
[self.rewardedVideoAd loadAdData];
</div></code></pre>
<h4 id="224-burewardedvideomodel">2.2.4 BURewardedVideoModel</h4>
<pre class="hljs"><code><div>@interface BURewardedVideoModel : NSObject

/**
required.
Third-party game user_id identity.
Mainly used in the reward issuance, it is the callback pass-through parameter from server-to-server.
It is the unique identifier of each user.
In the non-server callback mode, it will also be pass-through when the video is finished playing.
Only the string can be passed in this case, not nil.
*/
@property (nonatomic, copy) NSString *userId;

//optional. reward name.
@property (nonatomic, copy) NSString *rewardName;

//optional. number of rewards.
@property (nonatomic, assign) NSInteger rewardAmount;

//optional. serialized string.
@property (nonatomic, copy) NSString *extra;

// Whether to display the download Bar, the default is YES.
@property (nonatomic, assign) BOOL isShowDownloadBar;

@end

</div></code></pre>
<h4 id="225-%E3%82%B5%E3%83%BC%E3%83%90%E3%81%8B%E3%82%89%E3%82%B5%E3%83%BC%E3%83%90%E3%81%B8%E3%81%AE%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF">2.2.5 サーバからサーバへのコールバック</h4>
<p>サーバからサーバへのコールバックにより、リワード広告を見るユーザに報酬を提供するか否かを判定できます。ユーザが広告を最後まで見た場合は、ToutiaoのメディアプラットフォームでToutiaoサーバからお客様自身のサーバへコールバックURLを割り当て、ユーザの操作完了を伝えることができます。</p>
<h5 id="%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E6%96%B9%E6%B3%95%E3%81%AE%E8%AA%AC%E6%98%8E">コールバック方法の説明</h5>
<p>ToutiaoのサーバはGET方式で第三者のサービスのコールバックURLをリクエストし、以下のパラメータを返します。
user_id=%s&amp;trans_id=%s&amp;reward_name=%s&amp;reward_amount=%d&amp;extra=%s&amp;sign=%s</p>
<table>
<thead>
<tr>
<th>フィールドの定義</th>
<th>フィールド名</th>
<th>フィールドタイプ</th>
<th>注釈</th>
</tr>
</thead>
<tbody>
<tr>
<td>sign</td>
<td>サイン</td>
<td>string</td>
<td>サイン</td>
</tr>
<tr>
<td>user_id</td>
<td>ユーザid</td>
<td>string</td>
<td>SDKパススルーを呼び出し、アプリケーション側がユーザを識別唯一のもの</td>
</tr>
<tr>
<td>trans_id</td>
<td>取引id</td>
<td>string</td>
<td>最後まで見た場合の唯一の取引ID</td>
</tr>
<tr>
<td>reward_amount</td>
<td>リワード数</td>
<td>int</td>
<td>TikTok Audience Networkから割り当てられるかSDKを呼び出して入れる</td>
</tr>
<tr>
<td>reward_name</td>
<td>リワード名</td>
<td>string</td>
<td>TikTok Audience Networkから割り当てられるかSDKを呼び出して入れる</td>
</tr>
<tr>
<td>extra</td>
<td>Extra</td>
<td>string</td>
<td>SDKを呼び出して入れ、パススルーします。必要ない場合はヌルになります。</td>
</tr>
</tbody>
</table>
<h5 id="%E3%82%B5%E3%82%A4%E3%83%B3%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95">サイン作成方法</h5>
<p>appSecurityKey: TikTok Audience Networkのリワード動画コードビットの作成で取得したキーtransId：取引id sign = sha256(appSecurityKey:transId)</p>
<p>Pythonを例にする場合：</p>
<pre class="hljs"><code><div>import hashlib

if __name__ == &quot;__main__&quot;:
trans_id = &quot;6FEB23ACB0374985A2A52D282EDD5361u6643&quot;
app_security_key = &quot;7ca31ab0a59d69a42dd8abc7cf2d8fbd&quot;
check_sign_raw = &quot;%s:%s&quot; % (app_security_key, trans_id)
sign = hashlib.sha256(check_sign_raw).hexdigest()
</div></code></pre>
<h5 id="%E8%A6%8F%E7%B4%84%E3%81%AB%E6%88%BB%E3%82%8B">規約に戻る</h5>
<p>jsonデータをレスポンスします。フィールドは以下の通り。</p>
<table>
<thead>
<tr>
<th>フィールドの定義</th>
<th>フィールド名</th>
<th>フィールドタイプ</th>
<th>注釈</th>
</tr>
</thead>
<tbody>
<tr>
<td>isValid</td>
<td>校正結果</td>
<td>bool</td>
<td>判定結果、リワードを支給するか。</td>
</tr>
</tbody>
</table>
<p>例：</p>
<pre class="hljs"><code><div>{
&quot;isValid&quot;: true
}
</div></code></pre>
<h4 id="226-admob%E3%81%8Ccustomevent-adapter%E3%81%AE%E6%96%B9%E6%B3%95%E3%81%A7%E3%83%AA%E3%83%AF%E3%83%BC%E3%83%89%E5%8B%95%E7%94%BB%E3%82%92%E7%B5%B1%E5%90%88%E3%81%99%E3%82%8B">2.2.6 AdMobがCustomEvent Adapterの方法でリワード動画を統合する</h4>
<p>AdMobでリワード動画を統合するには二つの方法があります。一つはAdMob広告連盟で、もう一つはCustomEvent Adapterで統合する方法です。現在、JinriToutiaoは二つ目の方法をサポートしており、CustomEventを設定し、CustomEvent Adapterを実現する必要があります。<a href="https://developers.google.com/admob/ios/rewarded-video-adapters?hl=zh-CN">Rewarded Video Adapters</a>公式サイトのガイドラインをご参照ください</p>
<p>リワード動画のリクエスト方法は<a href="https://developers.google.com/admob/ios/rewarded-video?hl=zh-CN">Rewarded Video</a>公式サイトのガイドラインをご参照ください</p>
<p>広告テストは<a href="https://developers.google.com/admob/ios/test-ads?hl=zh-CN#enable_test_devices">Test Ads</a>をご参照ください</p>
<p>接続中の問題を減らすために、以下の点にご注意ください。</p>
<ul>
<li><strong>CustomEventを設定するときは、Class Nameと実現するAdapterクラス名を一致させる必要があります。一致していない場合はadapterの呼び出しができません。</strong></li>
<li><strong>iOS simulatorはデフォルトではEnable test deviceタイプのデバイスに設定されており、Google Test Adsしか取得できず、JinriToutiaoのテスト広告は取得できません。JinriToutiaoの広告をテストしたい場合はiOSの実機を使用してください。追加してAdMob TestDevicesに追加しないでください。</strong></li>
</ul>
<h3 id="23-%E3%83%95%E3%83%AB%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E5%8B%95%E7%94%BBbufullscreenvideoad">2.3 フルスクリーン動画(BUFullscreenVideoAd)</h3>
<ul>
<li>**タイプの説明：**フルスクリーン動画はフルスクリーンで動画広告を展示する広告形式です。ユーザはシーン毎に対応する広告を入れることができます。この種の広告の長さは15～30秒で、スキップできます。また、endCard終了画面を表示し、ユーザに次の操作に移るよう誘導します。</li>
</ul>
<h4 id="231-bufullscreenvideoad%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%95%E3%82%A7%E3%82%A4%E3%82%B9%E3%81%AE%E8%AA%AC%E6%98%8E">2.3.1 BUFullscreenVideoAdインターフェイスの説明</h4>
<p><strong>毎回、新しいBUFullscreenVideoAdオブジェクトを生成し、loadAdDataを呼び出す方法で、最新リワード動画をリクエストする必要があります。繰り返しローカルキャッシュを使用して、何度もリワード動画を展示することはやめてください。</strong></p>
<pre class="hljs"><code><div>@interface BUFullscreenVideoAd : NSObject

@property (nonatomic, weak, nullable) id&lt;BUFullscreenVideoAdDelegate&gt; delegate;
@property (nonatomic, getter=isAdValid, readonly) BOOL adValid;

/**
Initializes video ad with slot id.
@param slotID : the unique identifier of video ad.
@return BUFullscreenVideoAd
*/
- (instancetype)initWithSlotID:(NSString *)slotID;

/**
Load video ad datas.
*/
- (void)loadAdData;

/**
Display video ad.
@param rootViewController : root view controller for displaying ad.
@return : whether it is successfully displayed.
*/
- (BOOL)showAdFromRootViewController:(UIViewController *)rootViewController;

@end
</div></code></pre>
<h4 id="232-bufullscreenvideoad%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E3%81%AE%E8%AA%AC%E6%98%8E">2.3.2 BUFullscreenVideoAdコールバックの説明</h4>
<pre class="hljs"><code><div>@protocol BUFullscreenVideoAdDelegate &lt;NSObject&gt;

@optional

/**
This method is called when video ad material loaded successfully.
*/
- (void)fullscreenVideoMaterialMetaAdDidLoad:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad materia failed to load.
@param error : the reason of error
*/
- (void)fullscreenVideoAd:(BUFullscreenVideoAd *)fullscreenVideoAd didFailWithError:(NSError *)error;

/**
This method is called when video cached successfully.
*/
- (void)fullscreenVideoAdVideoDataDidLoad:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad slot will be showing.
*/
- (void)fullscreenVideoAdWillVisible:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad slot has been shown.
*/
- (void)fullscreenVideoAdDidVisible:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad is clicked.
*/
- (void)fullscreenVideoAdDidClick:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad is about to close.
*/
- (void)fullscreenVideoAdWillClose:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad is closed.
*/
- (void)fullscreenVideoAdDidClose:(BUFullscreenVideoAd *)fullscreenVideoAd;


/**
This method is called when video ad play completed or an error occurred.
@param error : the reason of error
*/
- (void)fullscreenVideoAdDidPlayFinish:(BUFullscreenVideoAd *)fullscreenVideoAd didFailWithError:(NSError *)error;

/**
This method is called when the user clicked skip button.
*/
- (void)fullscreenVideoAdDidClickSkip:(BUFullscreenVideoAd *)fullscreenVideoAd;

@end
</div></code></pre>
<h4 id="233-%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9">2.3.3 インスタンス</h4>
<pre class="hljs"><code><div>- (void)viewDidLoad {
	[super viewDidLoad];
	// Do any additional setup after loading the view.
	#warning----- Every time the data is requested, a new one BUFullscreenVideoAd needs to be initialized. Duplicate request data by the same full screen video ad is not allowed.
	self.fullscreenVideoAd = [[BUFullscreenVideoAd alloc] initWithSlotID:self.viewModel.slotID];
	self.fullscreenVideoAd.delegate = self;
	[self.fullscreenVideoAd loadAdData];
	[self.view addSubview:self.button];
}

- (UIButton *)button {
	if (!_button) {
		CGSize size = [UIScreen mainScreen].bounds.size;
		_button = [[BUDNormalButton alloc] initWithFrame:CGRectMake(0, size.height*0.75, 0, 0)];
		[_button setTitle:[NSString localizedStringForKey:ShowFullScreenVideo] forState:UIControlStateNormal];
		[_button addTarget:self action:@selector(buttonTapped:) forControlEvents:UIControlEventTouchUpInside];
	}
	return _button;
}

- (void)buttonTapped:(id)sender {
	/**Return YES when material is effective,data is not empty and has not been displayed.
	Repeated display is not charged.
	*/
	[self.fullscreenVideoAd showAdFromRootViewController:self.navigationController];
}

</div></code></pre>
<h2 id="%E4%BB%98%E9%8C%B2">付録</h2>
<h3 id="sdk%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%B3%E3%83%BC%E3%83%89">SDKエラーコード</h3>
<p>データ取得における異常は主にコールバック方法で処理されます。</p>
<pre class="hljs"><code><div>- (void)rewardedVideoAd:(BURewardedVideoAd *)rewardedVideoAd didFailWithError:(NSError *)error;
- (void)fullscreenVideoAd:(BUFullscreenVideoAd *)fullscreenVideoAd didFailWithError:(NSError *)error;
</div></code></pre>
<p>以下は各種のerror codeの値です。</p>
<pre class="hljs"><code><div>
BUErrorCodeTempError        = -6, // native template is invalid
BUErrorCodeTempAddationError= -5, // native template addation is invalid
BUErrorCodeOpenAPPStoreFail = -4, // failed to open appstore
BUErrorCodeNOAdError        = -3, // parsed data has no ads
BUErrorCodeNetError         = -2, // network request failed
BUErrorCodeParseError       = -1, // parsing failed

BUErrorCodeParamError       = 10001,  // parameter error
BUErrorCodeTimeout          = 10002,

BUErrorCodeSuccess          = 20000,
BUErrorCodeNOAD             = 20001,  // no ads

BUErrorCodeContentType      = 40000,  // http conent_type error
BUErrorCodeRequestPBError   = 40001,  // http request pb error
BUErrorCodeAppEmpty         = 40002,  // request app can't be empty
BUErrorCodeWapEMpty         = 40003,  // request wap can't be empty
BUErrorCodeAdSlotEmpty      = 40004,  // missing ad slot description
BUErrorCodeAdSlotSizeEmpty  = 40005,  // the ad slot size is invalid
BUErrorCodeAdSlotIDError    = 40006,  // the ad slot ID is invalid
BUErrorCodeAdCountError     = 40007,  // request the wrong number of ads
BUErrorCodeAdPackageIncomplete = 40025, // the SDK package is incomplete. It is recommended to verify the integrity of SDK package or contact technical. support

BUErrorCodeSysError         = 50001   // ad server error
</div></code></pre>
<h3 id="faq">FAQ</h3>
<p>1.iOSの広告画面をappで開くと、閉じたり、戻ったりすることができません。</p>
<p>答え：お使いのホームページViewControllerでNavigationBarを非表示にしている場合、戻ることができません。</p>
<p>2.ToutiaoSDKのBUWebViewControllerクラスとTTRUIWebViewクラスにメモリのリークがあります。</p>
<p>答え：システムによる問題です。UIWebViewではリークが発生します。WKWebViewへの取り替えを検討しています。</p>
<p>3.リワード動画を再生するとき、orientationは設定できますか。</p>
<p>答え：orientationはsdkにより現在のスクリーンの状態を読み取ります。開発者による設定は不要です。バックグラウンドが該当する広告のクリエイティブ（横向きクリエイティブ、縦向きクリエイティブ)をレスポンスします。</p>
<p>4.userIdとは何ですか。</p>
<p>答え：第三者のゲームのuser_idの認証アカウントで、主にリワードが有効となるかを判定する過程で、サーバからサーバへのコールバックパススルーされるパラメータで、ゲームがユーザを識別する唯一のものです。非サーバコールバックモードは動画再生終了後のコールバックにおいても、ゲームアプリケーションにパススルーされますが、この時、ヌルの文字列がパススルーされ、nilは送られません。</p>
<p>5.iOSをまとめたパッケージのサイズはどれくらいですか？</p>
<p>答え：demoパッケージをもとに計算すると約580kです。しかし、具体的なサイズは導入した機能により異なりますので、実際のサイズはまとめた後のパッケージサイズに準じます。</p>
<p>6.リワード動画とフルスクリーン動画における素材ロードのコールバック成功と広告動画におけるクリエイティブキャッシュのコールバック成功にはどのような違いがあるのでしょうか。</p>
<p>答え：素材ロードの成功とは広告素材のクリエイティブのロード完了を言い、広告を展示することができます。但し、動画はシングルスレッドでロードされるため、この時の動画データはキャッシュができていません。そのため、インターネットの接続状況が悪い中で動画類を再生する際は、リアルタイムでデータをロードするため、動画が止まることがあります。スムーズに再生するためには、広告動画のクリエイティブのキャッシュができる時に広告を展示されることをお勧めします。</p>

</body>
</html>
